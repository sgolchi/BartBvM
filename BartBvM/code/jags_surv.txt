model {

  C <- 10000  # this just has to be large enough to ensure phi > 0

  comp1 <- sum(e_seg * log_h)
  
  comp2 <- e_grp * beta

  comp3 <- sum(e_0 * h)

  comp4 <- exp(beta)*sum(e_1 * h)

  phi <- comp3 + comp4 - comp1 - comp2 + C
  zero ~ dpois(phi)

  for (k in 1:K){
    h[k] <- exp(log_h[k]) 
  }
  
  # Priors for coefficients
  beta ~ dnorm(0, prec_beta)

  # Priors for baseline hazard
  for (k in 1:K) {
    log_h[k] ~ dnorm(0, prec_logh[k])
  }
}